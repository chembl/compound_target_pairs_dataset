<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sanity_checks module &mdash; compound_target_pairs_dataset 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=fdc28d34" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=d45e8c67"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="write_subsets module" href="write_subsets.html" />
    <link rel="prev" title="main module" href="main.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            compound_target_pairs_dataset
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="columns_docs.html">Columns in the Final Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_guide.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">src</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="add_chembl_compound_properties.html">add_chembl_compound_properties module</a></li>
<li class="toctree-l2"><a class="reference internal" href="add_chembl_target_class_annotations.html">add_chembl_target_class_annotations module</a></li>
<li class="toctree-l2"><a class="reference internal" href="add_dti_annotations.html">add_dti_annotations module</a></li>
<li class="toctree-l2"><a class="reference internal" href="add_rdkit_compound_descriptors.html">add_rdkit_compound_descriptors module</a></li>
<li class="toctree-l2"><a class="reference internal" href="clean_dataset.html">clean_dataset module</a></li>
<li class="toctree-l2"><a class="reference internal" href="get_activity_ct_pairs.html">get_activity_ct_pairs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="get_dataset.html">get_dataset module</a></li>
<li class="toctree-l2"><a class="reference internal" href="get_drug_mechanism_ct_pairs.html">get_drug_mechanism_ct_pairs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="get_stats.html">get_stats module</a></li>
<li class="toctree-l2"><a class="reference internal" href="main.html">main module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">sanity_checks module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sanity_checks.check_atc_and_target_classes"><code class="docutils literal notranslate"><span class="pre">check_atc_and_target_classes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#sanity_checks.check_compound_props"><code class="docutils literal notranslate"><span class="pre">check_compound_props()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#sanity_checks.check_for_mixed_types"><code class="docutils literal notranslate"><span class="pre">check_for_mixed_types()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#sanity_checks.check_ligand_efficiency_metrics"><code class="docutils literal notranslate"><span class="pre">check_ligand_efficiency_metrics()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#sanity_checks.check_null_values"><code class="docutils literal notranslate"><span class="pre">check_null_values()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#sanity_checks.check_pairs_without_pchembl_are_in_drug_mechanisms"><code class="docutils literal notranslate"><span class="pre">check_pairs_without_pchembl_are_in_drug_mechanisms()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#sanity_checks.check_rdkit_props"><code class="docutils literal notranslate"><span class="pre">check_rdkit_props()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#sanity_checks.sanity_checks"><code class="docutils literal notranslate"><span class="pre">sanity_checks()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#sanity_checks.test_equality"><code class="docutils literal notranslate"><span class="pre">test_equality()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="write_subsets.html">write_subsets module</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">compound_target_pairs_dataset</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">src</a></li>
      <li class="breadcrumb-item active">sanity_checks module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/sanity_checks.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-sanity_checks">
<span id="sanity-checks-module"></span><h1>sanity_checks module<a class="headerlink" href="#module-sanity_checks" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sanity_checks.check_atc_and_target_classes">
<span class="sig-prename descclassname"><span class="pre">sanity_checks.</span></span><span class="sig-name descname"><span class="pre">check_atc_and_target_classes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_combined</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atc_levels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_classes_level1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_classes_level2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sanity_checks.html#check_atc_and_target_classes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sanity_checks.check_atc_and_target_classes" title="Link to this definition"></a></dt>
<dd><p>Check that atc_level1 and target class information is only null
if the parent_molregno / target id is not in the respective table.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sanity_checks.check_compound_props">
<span class="sig-prename descclassname"><span class="pre">sanity_checks.</span></span><span class="sig-name descname"><span class="pre">check_compound_props</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_combined</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_cpd_props</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sanity_checks.html#check_compound_props"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sanity_checks.check_compound_props" title="Link to this definition"></a></dt>
<dd><p>Check that compound props are only null if</p>
<ul class="simple">
<li><p>the property in the parent_molregno is not in df_cpd_props</p></li>
<li><p>or if the value in the compound props table is null.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sanity_checks.check_for_mixed_types">
<span class="sig-prename descclassname"><span class="pre">sanity_checks.</span></span><span class="sig-name descname"><span class="pre">check_for_mixed_types</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_combined</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sanity_checks.html#check_for_mixed_types"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sanity_checks.check_for_mixed_types" title="Link to this definition"></a></dt>
<dd><p>Check that there are no mixed types in columns with dtype=object.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sanity_checks.check_ligand_efficiency_metrics">
<span class="sig-prename descclassname"><span class="pre">sanity_checks.</span></span><span class="sig-name descname"><span class="pre">check_ligand_efficiency_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_combined</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sanity_checks.html#check_ligand_efficiency_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sanity_checks.check_ligand_efficiency_metrics" title="Link to this definition"></a></dt>
<dd><p>Check that ligand efficiency metrics are only null
when at least one of the values used to calculate them is null.
Ligand efficiency metrics are only null when at least one of the values used to calculate them is null.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sanity_checks.check_null_values">
<span class="sig-prename descclassname"><span class="pre">sanity_checks.</span></span><span class="sig-name descname"><span class="pre">check_null_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_combined</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sanity_checks.html#check_null_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sanity_checks.check_null_values" title="Link to this definition"></a></dt>
<dd><p>Check if any columns contain nan or null which aren’t recognised as null values.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sanity_checks.check_pairs_without_pchembl_are_in_drug_mechanisms">
<span class="sig-prename descclassname"><span class="pre">sanity_checks.</span></span><span class="sig-name descname"><span class="pre">check_pairs_without_pchembl_are_in_drug_mechanisms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_combined</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sanity_checks.html#check_pairs_without_pchembl_are_in_drug_mechanisms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sanity_checks.check_pairs_without_pchembl_are_in_drug_mechanisms" title="Link to this definition"></a></dt>
<dd><p>Check that rows without a pchembl value based on binding+functional assays (pchembl_x_BF) are in the drug_mechanism table.
Note that this is not true for the pchembl_x_B columns which are based on binding data only.
They may be in the table because there is data based on functional assays but no data based on binding assays.
All pchembl_value_x_BF columns without a pchembl should be in the dm table.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sanity_checks.check_rdkit_props">
<span class="sig-prename descclassname"><span class="pre">sanity_checks.</span></span><span class="sig-name descname"><span class="pre">check_rdkit_props</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_combined</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sanity_checks.html#check_rdkit_props"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sanity_checks.check_rdkit_props" title="Link to this definition"></a></dt>
<dd><p>Check that columns set by the RDKit are only null if there is no canonical SMILES for the molecule.
Scaffolds are excluded from this test because they can be None if the molecule is acyclic.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sanity_checks.sanity_checks">
<span class="sig-prename descclassname"><span class="pre">sanity_checks.</span></span><span class="sig-name descname"><span class="pre">sanity_checks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_combined</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_cpd_props</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atc_levels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_classes_level1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_classes_level2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_RDKit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sanity_checks.html#sanity_checks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sanity_checks.sanity_checks" title="Link to this definition"></a></dt>
<dd><p>Check basic assumptions about the finished dataset, specifically:</p>
<ul class="simple">
<li><p>no columns contain nan or null values which aren’t recognised as null values</p></li>
<li><p>there are no mixed types in columns with dtype=object</p></li>
<li><p>rows without a pchembl value based on binding+functional assays (pchembl_x_BF) are in the drug_mechanism table</p></li>
<li><p>ligand efficiency metrics are only null when at least one of the values used to calculate them is null</p></li>
<li><p>compound props are only null if the compound is not in df_cpd_props or the value in that table is null</p></li>
<li><p>atc_level1 and target class information is only null if the parent_molregno / target id is not in the respective table</p></li>
<li><p>columns set by the RDKit are only null if there is no canonical SMILES for the molecule (excluding scaffolds)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_combined</strong> (<em>pd.DataFrame</em>) – Pandas DataFrame with compound-target pairs</p></li>
<li><p><strong>df_cpd_props</strong> (<em>pd.DataFrame</em>) – Pandas DataFrame with compound properties and structures for all compound ids in ChEMBL.</p></li>
<li><p><strong>atc_levels</strong> (<em>pd.DataFrame</em>) – Pandas DataFrame with ATC annotations in ChEMBL</p></li>
<li><p><strong>target_classes_level1</strong> (<em>pd.DataFrame</em>) – Pandas DataFrame with mapping from target id to level 1 target class</p></li>
<li><p><strong>target_classes_level2</strong> (<em>pd.DataFrame</em>) – Pandas DataFrame with mapping from target id to level 2 target class</p></li>
<li><p><strong>calculate_RDKit</strong> (<em>bool</em>) – True if the DataFrame contains RDKit-based compound properties</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sanity_checks.test_equality">
<span class="sig-prename descclassname"><span class="pre">sanity_checks.</span></span><span class="sig-name descname"><span class="pre">test_equality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_file_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assay_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_type_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_RDKit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sanity_checks.html#test_equality"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sanity_checks.test_equality" title="Link to this definition"></a></dt>
<dd><p>Check that the file that was written to &lt;read_file_name&gt;
is identical to the DataFrame &lt;current_df&gt; it was based on.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_df</strong> (<em>pd.DataFrame</em>) – Pandas DataFrame that was written to read_file_name</p></li>
<li><p><strong>read_file_name</strong> (<em>str</em>) – Name of the file current_df was written to</p></li>
<li><p><strong>assay_type</strong> (<em>str</em>) – Types of assays current_df contains information about.         Options: “BF” (binding+functional), “B” (binding), “all” (contains both BF and B information)</p></li>
<li><p><strong>file_type_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of file extensions used with read_file_name. Options: csv, xlsx</p></li>
<li><p><strong>calculate_RDKit</strong> (<em>bool</em>) – If True, current_df contains RDKit-based columns</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="main.html" class="btn btn-neutral float-left" title="main module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="write_subsets.html" class="btn btn-neutral float-right" title="write_subsets module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Lina Heinzke, Barbara Zdrazil.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>